(()=>{var o=class{state;constructor(t){this.state=t}get(t){return this.state.get(t)}set(t,e){return this.state.set(t,e),e}};var i="theme";var r=class{themeSwitcherEl=document.querySelector(".theme-switcher");moonIconEl=document.getElementById("moon-icon");sunIconEl=document.getElementById("sun-icon");appRoot=document.getElementById("app");html=document.documentElement;theme;DOMParser=new DOMParser;cache=new o(new Map);constructor(){this.initTheme(),this.initRouting()}initTheme=()=>{this.theme=localStorage.getItem(i)??"dark",this.themeSwitcherEl.addEventListener("click",this.handleTheme),this.renderIcon(this.theme),this.html.setAttribute(`data-${i}`,this.theme)};initRouting=()=>{this.attachHeaderLinkListeners(),this.attachContentLinkListeners(),self.addEventListener("popstate",this.handlePopstate),this.cache.set(location.pathname,document.querySelector("main")),this.isPostPage()&&this.fetchPostImage()};renderIcon(t){t==="dark"&&(this.themeSwitcherEl.innerHTML=this.moonIconEl.innerHTML),t==="light"&&(this.themeSwitcherEl.innerHTML=this.sunIconEl.innerHTML)}handleTheme=()=>{let e=this.html.getAttribute(`data-${i}`)==="dark"?"light":"dark";this.html.setAttribute(`data-${i}`,e),localStorage.setItem(i,e),this.renderIcon(e)};attachContentLinkListeners=()=>{let t=document.querySelectorAll("main a");Array.from(t).filter(n=>n.getAttribute("href")?.startsWith("/")).forEach(n=>n.addEventListener("click",this.handleLink))};attachHeaderLinkListeners=()=>{let t=document.querySelectorAll("header a");Array.from(t).filter(n=>n.getAttribute("href")?.startsWith("/")).forEach(n=>n.addEventListener("click",this.handleLink))};handlePopstate=async()=>{let t=location.pathname;this.updateNavLink(document.querySelector(`nav a[href="${t}"]`));let e=this.cache.get(t);if(e){let n=document.querySelector("main");this.appRoot.replaceChild(e,n)}else{let n=await this.fetchPageContent(t),a=this.parsePageContent(n);this.cache.set(t,a);let s=document.querySelector("main");this.appRoot.replaceChild(a,s),this.attachContentLinkListeners(),this.isPostPage()&&this.fetchPostImage()}};handleLink=async t=>{t.preventDefault();let e=t.currentTarget,n=e.getAttribute("href")??"";if(n===location.pathname)return;this.updateNavLink(n==="/"?document.querySelector("nav a"):e);let a=this.cache.get(n);if(a){let s=document.querySelector("main");this.appRoot.replaceChild(a,s),history.pushState({},"",n)}else{let s=await this.fetchPageContent(n),c=this.parsePageContent(s);this.cache.set(n,c);let m=document.querySelector("main");this.appRoot.replaceChild(c,m),history.pushState({},"",n),this.attachContentLinkListeners(),this.isPostPage()&&this.fetchPostImage()}};updateNavLink=t=>{let e=document.querySelector('header nav a[data-active="true"]');e&&(e.classList.remove("text-main","text-semibold"),e.classList.add("text-secondary"),e.removeAttribute("data-active")),t&&t.parentElement?.tagName==="NAV"&&(t.classList.remove("text-secondary"),t.classList.add("text-main","text-semibold"),t.setAttribute("data-active","true"))};fetchPageContent=async t=>await(await fetch(`${t}?clientside=true`)).text();parsePageContent=t=>this.DOMParser.parseFromString(t,"text/html").querySelector("main");isPostPage=()=>!!document.getElementById("post-image");fetchPostImage=async()=>{let e=await(await fetch("/static/personal-blog-with-deno.webp")).blob(),n=URL.createObjectURL(e),a=new Image;a.classList.add("absolute","left-0","w-full","h-full"),a.src=n,document.getElementById("post-image").append(a)}};new r;})();
